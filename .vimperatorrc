" Start Loading "{{{1
echo "Vimperator Loading..."

" Main Settings "{{{1
set wildoptions=auto
set complete=sl
set nextpattern=^次(へ|の|ペ),^続き,\bnext\b,^>$,^(>>|&#187;)$,^(>|&#187;),(>|&#187;)$,\bmore\b
set previouspattern=^前(へ|の|ペ),^戻る,\bprev|previous\b,^<$,^(<<|&#171;)$,^(<|&#171;),(<|&#171;)$
set focuscontent
set ignorecase
set guioptions=r
set visualbell
hi Bell display:none;
"set editor=meadow
set editor=gvim

" Visual "{{{1
"" ステータスバーのフォントサイズを大きくする
style chrome://* <<EOM
#liberator-statusline {
    font-family: Menlo, Consolas, Monaco, monospace !important;
    font-weight: normal !important;
    font-size: 10pt !important;
    padding:2px 2px !important;
}
EOM

"" ステータスバー
hi StatusLine color: #000; background: #BBB; font-weight: normal; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace;
hi StatusLineSecure color: #000; background: #9CF; font-weight: normal;
hi StatusLineExtended color: #000; background: #9FF; font-weight: normal;
hi StatusLineBroken color: #FFF; background: #900; font-weight: normal;

"" コマンドライン
hi CmdLine color: #000; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; padding: 2px;
hi Normal color: #000; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " 通常時テキスト
hi InfoMsg color: #000; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; "通知メッセージ
hi ModeMsg color: #000; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; "モード表示
hi MoreMsg color: #000; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; "さらにモード表示
hi ErrorMsg color: #FFF; background: #F00; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " エラーメッセージ
hi LineNr color: #F00; background: #FFF; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " エラーの行番号

"" 補完リスト
hi CompTitle font-weight: bold; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " タイトル
hi CompResult width: 600px; max-width: 600px; display: inline-block; overflow: hidden; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " 結果欄（左側）
hi CompDesc width: 600px; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " 説明欄（右側）
hi CompItem font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " 補完リストの1行
hi CompItem[selected] color: #FFF; background: #000; font-weight: normal; font-size: 10pt; font-family: Menlo, Consolas, Monaco, monospace; " 補完リストの選択している行
hi Filter color: #06E; font-weight: bold; " 補完リストでマッチしたテキスト

"" フィードアイコンをステータスバーに表示
javascript <<EOF
(function(){
    var feedPanel = document.createElement("statusbarpanel");
    feedPanel.setAttribute("id", "feed-panel-clone");
    feedPanel.appendChild(document.getElementById("feed-button"));
    feedPanel.firstChild.setAttribute("style", "padding: 0; max-height: 16px;");
    document.getElementById("status-bar")
            .insertBefore(feedPanel, document.getElementById("security-button"));
})();
EOF
" Key mapping "{{{1
"yank region
map y :echo 'Yank!'<CR>Y
"j/kの移動量増加
map j 8<C-e>
map k 8<C-y>
"h/lでタブ移動
map h <C-p>
map l <C-n>
"restart firefox
map <M-r> :restart<CR>
" Hatena Bookmark Search
map B :hbs<Space>
" Wikipedia
map W :open wikipedia<Space>
" JavaScript
map ,j :javascript<Space>
map ,J :open javascript:

" Command {{{1
" calendar
:command cal :js liberator.echo(<datepicker type="grid" xmlns={XUL}/>)
" コマンドラインでime off
:style -name comandline-ime chrome://* #liberator-commandline-command input {ime-mode: inactive;}

" Plugin "{{{1

" feeder.js "{{{2

" twitter.js "{{{2

" copy.js "{{{2
javascript <<EOM
liberator.globalVariables.copy_templates = [
{ label: 'titleAndtinyurl',value: 'TITLE and TinyURL', custom: function(){ return buffer.title + ' - ' +  util.httpGet('http://tinyurl.com/api-create.php?url=' + encodeURIComponent(buffer.URL)).responseText; } },
];
EOM

map ,t :tw<Space>
map ,l :copy<Space>titleAndtinyurl<CR>:tw<Space>Browsing: <S-Insert>
map ,u :copy<Space>%URL%<CR>
map ,c :copy<Space>%TITLE% %URL%<CR>

" feedSomeKeys_2.js "{{{2 http://coderepos.org/share/browser/lang/javascript/vimperator-plugins/trunk/feedSomeKeys_2.js
autocmd LocationChange .* :fmapc
autocmd LocationChange 'reader\.livedoor\.com/reader' :fmap j k s a p o v c <Space> <S-Space> Z z b < >
autocmd LocationChange 'mail\.google\.com/mail' :fmap c / y j k n p o u e x s r a # [ ] z ? gi gs gt gd ga gc

" _smooziee.js "{{{2 http://coderepos.org/share/browser/lang/javascript/vimperator-plugins/trunk/_smooziee.js
let g:smooziee_scroll_amount="300"
let g:smooziee_scroll_interval="30"
" Addon "{{{1
" Hatena Bookmark "{{{2 'http://b.hatena.ne.jp/guide/firefox_addon'
javascript if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this}); 

" Finish Loading "{{{1
echo "Loading done! :-)" 

" __END__ "{{{1
" vim: set filetype=vim :
